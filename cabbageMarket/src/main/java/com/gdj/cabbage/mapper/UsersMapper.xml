<?xml version="1.0" encoding="UTF-8"?>
<!-- 작성자 이재범 -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gdj.cabbage.mapper.UsersMapper">
	<!-- 로그인 쿼리 -->
	<select id="loginSession" resultType="java.util.Map" parameterType="com.gdj.cabbage.vo.Users">
		SELECT
			user_id userId,
			email,
			nickname
		FROM
			users
		<where>
			email=#{email} AND password=PASSWORD(#{password})
		</where>			
	</select>
	
	<!-- 회원가입 쿼리 -->
	<insert id="registerUser" parameterType="com.gdj.cabbage.vo.Users">
		INSERT 
			users(
				username, 
				email, 
				password, 
				nickname, 
				mobile, 
				modify_date, 
				user_state, 
				create_date
				) 
		VALUES(
			#{username}, 
			#{email},
			PASSWORD(#{password}),
			#{nickname},
			#{mobile, jdbcType=VARCHAR},
			NOW(),
			1,
			NOW()
			) 
	</insert>
	
	<!-- email 중복 여부  -->
	<select id="selectEmail" resultType="Integer" parameterType="com.gdj.cabbage.vo.Users">
		SELECT
			COUNT(*)
		FROM
			users
		<where>
			email=#{email}
		</where>
	</select>
	
	<select id="selectNickname" resultType="Integer" parameterType="com.gdj.cabbage.vo.Users">
		SELECT
			COUNT(*)
		FROM
			users
		<where>
			nickname=#{nickname}
		</where>
	</select>
</mapper>