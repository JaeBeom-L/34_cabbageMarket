<?xml version="1.0" encoding="UTF-8"?>
<!-- 작성자 : 김태훈 -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gdj.cabbage.mapper.ApplyProductSalesMapper">

	<select id="selectApplyProductSalesDeliveryList" parameterType="int" resultType="map">
		SELECT apsd.apply_product_sales_delivery_id applyProductSalesDelivery_id,
			   apsd.user_id userId,
			   apsd.product_name productName,
			   apsd.return_address returnAddress,
			   apsd.waybill_number waybillNumber,
			   IF(ISNULL(pcr.registration_state), '심사중', '등록가능') AS registrationState,
			   cs.category_sub_name categorySubName
		  FROM category_sub cs INNER JOIN apply_product_sales_delivery apsd ON cs.category_sub_id = apsd.category_sub_id
							    LEFT JOIN product_confirmation_registration pcr ON apsd.apply_product_sales_delivery_id = pcr.apply_product_sales_delivery_id
		 WHERE apsd.user_id = #{userId} AND (pcr.registration_state = 9 OR ISNULL(pcr.registration_state))
	</select>

</mapper>